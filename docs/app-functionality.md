# Приложения и их функциональность в проекте Deadline Mate

В этом документе представлено подробное описание всех приложений/модулей проекта Deadline Mate, их структуры, функциональности и взаимодействия между собой. Проект построен на модульной архитектуре, где каждое приложение отвечает за определенную функциональную область.

## Общая структура приложений

Проект Deadline Mate разделен на следующие основные приложения:

1. **authentication** - управление пользователями, аутентификация и авторизация
2. **groups** - управление учебными группами
3. **assignments** - работа с заданиями и дедлайнами
4. **progress** - отслеживание прогресса выполнения заданий
5. **notifications** - система уведомлений
6. **analytics** - сбор и анализ данных по успеваемости
7. **core** - общие утилиты и базовая функциональность

Каждое приложение следует принципам Django, имея четкую структуру и отвечая за определенный аспект функциональности.

## 1. Приложение Authentication

### Назначение
Управление пользователями, их профилями, аутентификацией и авторизацией.

### Модели

#### CustomUser
Расширенная модель пользователя, заменяющая стандартную модель User из Django.

**Поля:**
- `username` - уникальное имя пользователя
- `email` - электронная почта (уникальная)
- `first_name` - имя
- `last_name` - фамилия
- `role` - роль пользователя (студент или преподаватель)
- Стандартные поля Django User: `is_active`, `is_staff`, `date_joined` и т.д.

**Методы:**
- `is_student()` - проверка, является ли пользователь студентом
- `is_teacher()` - проверка, является ли пользователь преподавателем
- `get_profile()` - получение связанного профиля в зависимости от роли

#### StudentProfile
Профиль пользователя-студента с дополнительной информацией.

**Поля:**
- `user` - связь с моделью CustomUser (OneToOne)
- `major` - специальность
- `year_of_study` - год обучения
- `bio` - краткая информация о студенте
- `avatar` - изображение профиля

#### TeacherProfile
Профиль пользователя-преподавателя с дополнительной информацией.

**Поля:**
- `user` - связь с моделью CustomUser (OneToOne)
- `position` - должность
- `department` - кафедра
- `academic_degree` - ученая степень
- `bio` - краткая информация о преподавателе
- `avatar` - изображение профиля

### Основная функциональность
- **Регистрация пользователей** с выбором роли
- **Аутентификация** через JWT
- **Управление профилями** с различными наборами полей в зависимости от роли
- **Сброс и изменение пароля**
- **Управление сессиями** и выход из системы

### API-эндпоинты
- `/api/auth/register/` - регистрация нового пользователя
- `/api/auth/login/` - авторизация пользователя
- `/api/auth/token/` - получение JWT-токена
- `/api/auth/token/refresh/` - обновление JWT-токена
- `/api/auth/me/` - получение/обновление данных текущего пользователя
- `/api/auth/password-reset/` - запрос на сброс пароля
- `/api/auth/logout/` - выход из системы

### Взаимодействие с другими приложениями
- Предоставляет базовый слой аутентификации для всех других приложений
- Передает информацию о ролях пользователей для определения доступа к функциям

## 2. Приложение Groups

### Назначение
Управление учебными группами, их участниками и преподавателями.

### Модели

#### Group
Основная модель для организации студентов.

**Поля:**
- `name` - название группы
- `code` - уникальный код для присоединения к группе
- `description` - описание группы
- `created_by` - создатель группы (ссылка на TeacherProfile)
- `created_at` - дата создания
- `updated_at` - дата последнего обновления
- `is_active` - статус активности группы

**Методы:**
- `generate_unique_code()` - генерация уникального кода для группы
- `get_member_count` - получение количества участников группы
- `get_teacher_count` - получение количества преподавателей группы

#### GroupMembership
Модель для связи студентов с группами.

**Поля:**
- `group` - связь с моделью Group
- `student` - связь с моделью StudentProfile
- `role` - роль в группе (обычный участник или староста)
- `joined_at` - дата присоединения
- `is_active` - статус активности участника в группе

#### GroupTeacher
Модель для связи преподавателей с группами.

**Поля:**
- `group` - связь с моделью Group
- `teacher` - связь с моделью TeacherProfile
- `joined_at` - дата присоединения
- `is_active` - статус активности преподавателя в группе

### Основная функциональность
- **Создание и управление группами** преподавателями
- **Присоединение студентов к группам** по уникальному коду
- **Назначение ролей** студентам в группах (обычный участник/староста)
- **Добавление нескольких преподавателей** к одной группе
- **Фильтрация и поиск групп** по различным критериям
- **Управление участниками группы** (добавление, удаление, изменение ролей)

### API-эндпоинты
- `/api/groups/` - получение списка групп/создание новой группы
- `/api/groups/{id}/` - получение/обновление/удаление конкретной группы
- `/api/groups/{id}/members/` - управление участниками группы
- `/api/groups/{id}/teachers/` - управление преподавателями группы
- `/api/groups/join/` - присоединение к группе по коду
- `/api/groups/{id}/join-as-teacher/` - присоединение к группе как преподаватель

### Взаимодействие с другими приложениями
- Используется приложением **Assignments** для назначения заданий группам
- Используется приложением **Analytics** для сбора статистики по группам
- Взаимодействует с **Progress** для отслеживания прогресса студентов в группе

## 3. Приложение Assignments

### Назначение
Управление учебными заданиями, дедлайнами и вложениями.

### Модели

#### Assignment
Основная модель для представления учебного задания.

**Поля:**
- `title` - название задания
- `description` - подробное описание задания
- `created_by` - автор задания (ссылка на TeacherProfile)
- `created_at` - дата создания
- `updated_at` - дата последнего обновления
- `deadline` - срок выполнения задания
- `max_points` - максимальное количество баллов
- `status` - статус задания (черновик, опубликовано, архив)
- `allow_late_submissions` - разрешать ли поздние отправки
- `late_penalty_percentage` - процент штрафа за позднюю отправку

**Методы:**
- `is_deadline_expired` - проверка, истек ли срок выполнения
- `get_time_remaining` - получение оставшегося времени до дедлайна
- `get_submission_count` - получение количества отправленных ответов

#### AssignmentAttachment
Модель для хранения вложений к заданиям.

**Поля:**
- `assignment` - связь с моделью Assignment
- `file` - загруженный файл
- `description` - описание вложения
- `uploaded_at` - дата загрузки

#### AssignmentGroup
Модель для связи заданий с группами.

**Поля:**
- `assignment` - связь с моделью Assignment
- `group` - связь с моделью Group
- `custom_deadline` - индивидуальный дедлайн для группы (опционально)
- `assigned_at` - дата назначения
- `assigned_by` - преподаватель, назначивший задание

### Основная функциональность
- **Создание и редактирование заданий** преподавателями
- **Управление дедлайнами** с возможностью установки индивидуальных сроков для групп
- **Прикрепление файлов** к заданиям (материалы, инструкции и т.д.)
- **Управление жизненным циклом задания** через статусы
- **Настройка политики поздней сдачи** (разрешение/запрет, штрафы)
- **Назначение заданий группам** с индивидуальными настройками
- **Отслеживание сроков** и оставшегося времени до дедлайна

### API-эндпоинты
- `/api/assignments/` - получение списка заданий/создание нового задания
- `/api/assignments/{id}/` - получение/обновление/удаление конкретного задания
- `/api/assignments/{id}/publish/` - публикация задания
- `/api/assignments/{id}/archive/` - архивация задания
- `/api/assignments/{id}/attachments/` - управление вложениями задания
- `/api/assignments/{id}/assign/` - назначение задания группе
- `/api/assignments/{id}/groups/` - получение групп, которым назначено задание

### Взаимодействие с другими приложениями
- Взаимодействует с **Groups** для назначения заданий группам
- Связано с **Progress** для отслеживания выполнения заданий
- Используется приложением **Notifications** для уведомления о новых заданиях и дедлайнах

## 4. Приложение Progress

### Назначение
Отслеживание прогресса выполнения заданий, оценивание работ и предоставление обратной связи.

### Модели

#### Submission
Основная модель для представления ответа студента на задание.

**Поля:**
- `assignment` - связь с моделью Assignment
- `student` - связь с моделью StudentProfile
- `submitted_at` - дата отправки
- `comment` - комментарий студента к решению
- `points` - полученные баллы (null до проверки)
- `status` - статус ответа (отправлен, проверен, возвращен на доработку)
- `feedback` - обратная связь от преподавателя
- `graded_by` - преподаватель, проверивший работу
- `graded_at` - дата проверки
- `is_late` - флаг поздней отправки

**Методы:**
- `calculate_late_penalty` - расчет штрафа за позднюю отправку
- `get_final_points` - получение итогового балла с учетом штрафов
- `get_attachments_count` - получение количества прикрепленных файлов

#### SubmissionAttachment
Модель для хранения вложений к ответам студентов.

**Поля:**
- `submission` - связь с моделью Submission
- `file` - загруженный файл
- `description` - описание вложения
- `uploaded_at` - дата загрузки

#### StudentProgress
Модель для агрегации прогресса студента по всем заданиям.

**Поля:**
- `student` - связь с моделью StudentProfile
- `total_assignments` - общее количество назначенных заданий
- `completed_assignments` - количество выполненных заданий
- `average_score` - средний балл
- `on_time_percentage` - процент заданий, выполненных вовремя
- `last_updated` - дата последнего обновления статистики

### Основная функциональность
- **Отправка ответов на задания** студентами
- **Прикрепление файлов** к ответам
- **Оценивание работ** преподавателями
- **Предоставление обратной связи** по работам
- **Возможность доработки** возвращенных ответов
- **Отслеживание прогресса** студентов и групп
- **Расчет штрафов** за поздние отправки
- **Формирование статистики** по выполнению заданий

### API-эндпоинты
- `/api/submissions/` - получение списка ответов/отправка нового ответа
- `/api/submissions/{id}/` - получение/обновление конкретного ответа
- `/api/submissions/{id}/attachments/` - управление вложениями ответа
- `/api/submissions/{id}/grade/` - оценивание ответа
- `/api/submissions/{id}/return/` - возврат ответа на доработку
- `/api/progress/student/` - получение прогресса студента
- `/api/progress/group/{group_id}/` - получение прогресса группы
- `/api/progress/assignment/{id}/` - получение прогресса по заданию

### Взаимодействие с другими приложениями
- Использует **Assignments** для получения информации о заданиях
- Предоставляет данные для **Analytics** для формирования аналитики
- Инициирует события для **Notifications** при оценивании работ

## 5. Приложение Notifications

### Назначение
Управление и доставка уведомлений пользователям о различных событиях в системе.

### Модели

#### Notification
Основная модель для представления уведомления.

**Поля:**
- `recipient` - получатель уведомления (связь с CustomUser)
- `title` - заголовок уведомления
- `message` - текст уведомления
- `notification_type` - тип уведомления (новое задание, приближающийся дедлайн, оценка и т.д.)
- `created_at` - дата создания
- `is_read` - статус прочтения
- `related_object_type` - тип связанного объекта (задание, ответ, группа)
- `related_object_id` - ID связанного объекта
- `url` - ссылка для перехода при клике на уведомление

#### NotificationSetting
Модель для хранения настроек уведомлений пользователя.

**Поля:**
- `user` - связь с моделью CustomUser
- `notification_type` - тип уведомления
- `email_enabled` - включены ли email-уведомления
- `in_app_enabled` - включены ли внутрисистемные уведомления
- `frequency` - частота получения уведомлений (сразу, ежедневный дайджест и т.д.)

### Основная функциональность
- **Создание и отправка уведомлений** на основе событий в системе
- **Маркировка уведомлений как прочитанных**
- **Фильтрация и группировка уведомлений**
- **Настройка предпочтений** для различных типов уведомлений
- **Отправка email-уведомлений** через интеграцию с почтовым сервисом
- **Агрегация уведомлений** для периодических дайджестов

### API-эндпоинты
- `/api/notifications/` - получение списка уведомлений пользователя
- `/api/notifications/unread/` - получение непрочитанных уведомлений
- `/api/notifications/{id}/read/` - отметка уведомления как прочитанного
- `/api/notifications/read-all/` - отметка всех уведомлений как прочитанных
- `/api/notifications/settings/` - получение/обновление настроек уведомлений

### Взаимодействие с другими приложениями
- Получает события от всех других приложений для генерации уведомлений
- Использует механизм сигналов Django для интеграции с другими модулями
- Предоставляет API для проверки статуса уведомлений из других приложений

## 6. Приложение Analytics

### Назначение
Сбор, анализ и визуализация данных об активности и успеваемости пользователей системы.

### Модели

#### AnalyticsSnapshot
Модель для хранения агрегированных данных по определенным периодам.

**Поля:**
- `snapshot_type` - тип снимка (студент, группа, задание)
- `reference_id` - ID объекта, к которому относится снимок
- `timestamp` - дата создания снимка
- `data` - JSON с агрегированными данными
- `period_start` - начало периода агрегации
- `period_end` - конец периода агрегации

#### ActivityLog
Модель для записи активности пользователей.

**Поля:**
- `user` - связь с моделью CustomUser
- `activity_type` - тип активности
- `timestamp` - время активности
- `related_object_type` - тип связанного объекта
- `related_object_id` - ID связанного объекта
- `meta_data` - дополнительные метаданные об активности

### Основная функциональность
- **Сбор данных** о производительности студентов и групп
- **Создание периодических снимков** агрегированных данных
- **Генерация отчетов** с различными метриками
- **Визуализация данных** через графики и диаграммы
- **Выявление трендов** и паттернов в данных
- **Предоставление прогнозной аналитики**
- **Отслеживание активности** пользователей и групп

### API-эндпоинты
- `/api/analytics/student/performance/` - аналитика успеваемости студента
- `/api/analytics/teacher/overview/` - обзор аналитики для преподавателя
- `/api/analytics/group/{group_id}/` - аналитика по группе
- `/api/analytics/assignments/summary/` - сводная аналитика по заданиям

### Взаимодействие с другими приложениями
- Использует данные из **Progress** для формирования аналитики
- Получает информацию о структуре групп из **Groups**
- Анализирует активность из **Assignments** и других модулей

## 7. Приложение Core

### Назначение
Предоставление общих утилит, базовых классов и функциональности, используемой всеми другими приложениями проекта.

### Модели

#### BaseModel
Абстрактная базовая модель с общими полями для многих моделей проекта.

**Поля:**
- `created_at` - дата создания
- `updated_at` - дата последнего обновления
- `is_active` - статус активности

#### SystemSetting
Модель для хранения глобальных настроек системы.

**Поля:**
- `key` - ключ настройки
- `value` - значение настройки
- `value_type` - тип значения (строка, число, булево, JSON)
- `description` - описание настройки
- `updated_at` - дата последнего обновления

### Основная функциональность
- **Предоставление базовых классов** для моделей и представлений
- **Общие утилиты** для всех приложений
- **Глобальные настройки системы**
- **Хелперы для работы с датами и временем**
- **Базовые функции для обработки файлов**
- **Централизованная обработка ошибок**
- **Общие миксины** для Django REST Framework
- **Базовые классы сериализаторов** с общей логикой

### API-эндпоинты
- `/api/status` - проверка статуса API

### Взаимодействие с другими приложениями
- Предоставляет базовые классы и утилиты для всех других приложений
- Используется всеми приложениями для повторного использования общей функциональности

## Взаимодействие между приложениями

### Основные взаимодействия

1. **Authentication ↔ Все приложения**
   - Предоставляет информацию о пользователях и их правах доступа
   - Управляет аутентификацией и авторизацией для всех API-эндпоинтов

2. **Groups ↔ Assignments**
   - Assignments использует информацию о группах для назначения заданий
   - Groups получает информацию о назначенных заданиях

3. **Assignments ↔ Progress**
   - Progress отслеживает выполнение заданий, созданных в Assignments
   - Assignments получает статистику выполнения заданий

4. **Progress ↔ Analytics**
   - Analytics использует данные из Progress для формирования аналитики
   - Progress может запрашивать агрегированные данные из Analytics

5. **Все приложения ↔ Notifications**
   - Все приложения генерируют события, которые могут создавать уведомления
   - Notifications обрабатывает эти события и отправляет уведомления пользователям

6. **Core ↔ Все приложения**
   - Предоставляет базовую функциональность для всех других приложений

### Механизмы взаимодействия

1. **Django Signals**
   - Используются для асинхронной коммуникации между приложениями
   - Позволяют реагировать на события в других приложениях без жёсткой связи

2. **Прямые ссылки через модели**
   - ForeignKey и ManyToMany связи между моделями разных приложений
   - Обеспечивают референциальную целостность данных

3. **API-вызовы**
   - Внутренние API-вызовы между различными компонентами
   - Используются для получения данных из других приложений

4. **Shared Services**
   - Общие сервисы, которые могут использоваться несколькими приложениями
   - Предоставляют унифицированный интерфейс для выполнения общих операций

## Заключение

Архитектура проекта Deadline Mate основана на принципе разделения ответственности, где каждое приложение отвечает за определенную функциональную область. Такой подход обеспечивает модульность, масштабируемость и улучшает поддерживаемость кода.

Четкое разделение функциональности по приложениям с хорошо определенными интерфейсами взаимодействия позволяет командам разработчиков работать над разными частями системы параллельно, не мешая друг другу.

Модульная архитектура также упрощает тестирование и отладку, позволяя изолировать отдельные компоненты системы и тестировать их независимо от остальных частей. 